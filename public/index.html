<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Air Quality Monitor Dashboard</title>

    <script defer src="/__/firebase/9.8.4/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/9.8.4/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<style>
    th {
        color: #000000;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        padding-top: 100px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 50%;
    }

    .modal-header {
        padding: 2px 16px;
        background-color: #23408e;
        color: white;
    }

    .close {
        color: white;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    body {
        background-image: url(https://img.freepik.com/premium-vector/background-white-elegant-texture_23-2148438404.jpg?w=2000);
    }

    canvas {
        max-height: 700px;
    }

    select {
        margin-bottom: 15px;
    }
</style>

<body>
<div class="container">
    <div class="row" style="text-align: center; padding: 30px 0;">
        <div class="col-md-3"></div>
        <div class="col-md-3">
            <h3 id="currentDate"></h3>
        </div>
        <div class="col-md-3">
            <h3 id="currentTime"></h3>
        </div>
        <div class="col-md-3"></div>
    </div>

    <!-- modal for temperature dashboard -->
    <div id="temperatureModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Temperature Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <!-- temperature date drop-down menu -->
                <label for="temperatureDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="temperatureDateArray"
                        onchange="selectTemperatureOption()"></select>
                <!-- temperature data chart -->
                <div id="temperatureChartContainer">
                    <canvas id="temperatureChart"></canvas>
                </div>
                <span style="color: #71A6D1">Below or Equals 22&#8451 = Low Temperature &#x2744;</span>
                <br>
                <span style="color: #FFA500">23&#8451 - 26&#8451 = Recommended Indoor Temperature &#127777;</span>
                <br>
                <span style="color: #bd1816">Above 26&#8451 = High Temperature &#128293;</span>
            </div>
        </div>
    </div>

    <!-- hidden firebase (temperature) date drop-down menu (used for timed refresh array purposes only) -->
    <select hidden id="firebaseDateArray"></select>

    <!--    modal for humidity dashboard-->
    <div id="humidityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Humidity Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="humidityDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="humidityDateArray"
                        onchange="selectHumidityOption()"></select>
                <div id="humidityChartContainer">
                    <canvas id="humidityChart"></canvas>
                </div>
                <span style="color: #4CBB17">0% - 59% = Low Risk of Mold Growth &#128516;</span>
                <br>
                <span style="color: #FFA500">60% - 79% = Risk of Mold Growth &#128577;</span>
                <br>
                <span style="color: #bd1816">80% - 100% = High Risk of Mold Growth &#128543;</span>
            </div>
        </div>
    </div>

    <!--    modal for carbon dioxide dashboard-->
    <div id="airQualityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Carbon Dioxide Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="airQualityDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="airQualityDateArray"
                        onchange="selectCarbonDioxideOption()"></select>
                <div id="airQualityChartContainer">
                    <canvas id="airQualityChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below or Equals 599ppm = Safe Levels of CO2 &#128516;</span>
                <br>
                <span style="color: #FFA500">600ppm - 799ppm = Alarming Levels of CO2 &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of CO2 &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for smoke dashboard-->
    <div id="smokeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Smoke Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="SmokeDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="SmokeDateArray"
                        onchange="selectSmokeOption()"></select>
                <div id="smokeChartContainer">
                    <canvas id="smokeChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 400ppm = Safe Levels of Smoke &#128516;</span>
                <br>
                <span style="color: #FFA500">400ppm - 799ppm = Alarming Levels of Smoke &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of Smoke &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for lpg dashboard-->
    <div id="lpgModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Liquefied Petroleum Gas Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="LPGDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="LPGDateArray" onchange="selectLPGOption()"></select>
                <div id="LPGChartContainer">
                    <canvas id="LPGChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 500ppm = Safe Levels of LPG &#128516;</span>
                <br>
                <span style="color: #FFA500">500ppm - 999ppm = Alarming Levels of LPG &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 1000ppm = Hazardous Levels of LPG &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for carbon monoxide dashboard-->
    <div id="coModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Carbon Monoxide Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="CODateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="CODateArray" onchange="selectCOOption()"></select>
                <div id="COChartContainer">
                    <canvas id="COChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 400ppm = Safe Levels of CO &#128516;</span>
                <br>
                <span style="color: #FFA500">400ppm - 799ppm = Alarming Levels of CO &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of CO &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for pm2.5 particulate dashboard-->
    <div id="PM25Modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>PM2.5 Particulate Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="PM25DateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="PM25DateArray" onchange="selectPM25Option()"></select>
                <div id="PM25ChartContainer">
                    <canvas id="PM25Chart"></canvas>
                </div>
                <span style="color: #4CBB17">Below or Equals 4ppm = Safe Levels of PM2.5 Particulate Matter &#128516;</span>
                <br>
                <span style="color: #FFA500">5ppm - 7ppm = Alarming Levels of PM2.5 Particulate Matter &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 8ppm = Hazardous Levels of PM2.5 Particulate Matter &#128128;</span>
            </div>
        </div>
    </div>

    <div class="row" style="justify-content: space-between;">
        <div id="temperatureIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Temperature &#127777;</h5>
            <h1 id="latestTemperature" style="color: #fff;"></h1>
        </div>
        <div id="humidityIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Humidity &#128167;</h5>
            <h1 id="latestHumidity" style="color: #fff;"></h1>
        </div>
        <div id="airQualityIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Carbon Dioxide &#128168;</h5>
            <h1 id="latestAirQuality" style="color: #fff;"></h1>
        </div>
    </div>

    <div class="row mt-5" style="justify-content: space-between;">
        <div id="smokeIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Smoke &#128684;</h5>
            <h1 id="latestSmoke" style="color: #fff;"></h1>
        </div>
        <div id="lpgIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Liquefied Petroleum Gas &#9981;</h5>
            <h1 id="latestLPG" style="color: #fff;"></h1>
        </div>
        <div id="coIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Carbon Monoxide &#128168;</h5>
            <h1 id="latestCO" style="color: #fff;"></h1>
        </div>
    </div>

    <div class="row mt-5">
        <div id="PM25Indicator" class="col-md-3" style="background-color:
        #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
        box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">PM2.5 Particulate&#128173;</h5>
            <h1 id="latestPM25" style="color: #fff;"></h1>
        </div>
    </div>
    <script>
        function dateComparison(a, b) {
            const date1 = new Date(a)
            const date2 = new Date(b)
            return date1 - date2;
        }

        // obtain historical temperature data after selecting date from drop-down menu
        function selectTemperatureOption() {
            var selectedTemperatureDate = document.getElementById("temperatureDateArray").value;
            let selectedDayTemp = 'DHT11/Temperature/' + selectedTemperatureDate;
            firebase.database().ref(selectedDayTemp).on('value', (snap) => {
                var tempStr = snap.val();
                var temperatureArray = [];

                Object.keys(tempStr).forEach((key) => {
                    temperatureArray.push({[key]: tempStr[key]});
                });

                var latestTemperature = temperatureArray[temperatureArray.length - 1];
                var temperatureValue = Object.values(latestTemperature);
                var jsonTemperatureValue = JSON.stringify(temperatureValue);

                jsonTemperatureValue = jsonTemperatureValue.split(":").pop();
                jsonTemperatureValue = jsonTemperatureValue.replaceAll("\"", "");
                jsonTemperatureValue = jsonTemperatureValue.replaceAll("}", "");
                jsonTemperatureValue = jsonTemperatureValue.replaceAll("]", "");

                var iterator = temperatureArray.values();
                var dateArray = [];
                var temperatureValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanTemperature = JSON.stringify(Object.values(elements));
                    cleanTemperature = cleanTemperature.split(":").pop();
                    cleanTemperature = cleanTemperature.replaceAll("\"", "");
                    cleanTemperature = cleanTemperature.replaceAll("}", "");
                    cleanTemperature = cleanTemperature.replaceAll("]", "");
                    temperatureValueArray.push(cleanTemperature);
                }

                document.getElementById("temperatureChartContainer").innerHTML = "";
                document.getElementById('temperatureChartContainer').innerHTML = "<canvas id=\"temperatureChart\"></canvas>";
                new Chart("temperatureChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: temperatureValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 10.00, max: 45.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectHumidityOption() {
            var selectedHumidityDate = document.getElementById("humidityDateArray").value;
            let selectedDayHumidity = 'DHT11/Humidity/' + selectedHumidityDate;
            firebase.database().ref(selectedDayHumidity).on('value', (snap) => {
                var humidityStr = snap.val();
                var humidityArray = [];

                Object.keys(humidityStr).forEach((key) => {
                    humidityArray.push({[key]: humidityStr[key]});
                });

                var latestHumidity = humidityArray[humidityArray.length - 1];
                var humidityValue = Object.values(latestHumidity);
                var jsonHumidityValue = JSON.stringify(humidityValue);

                jsonHumidityValue = jsonHumidityValue.split(":").pop();
                jsonHumidityValue = jsonHumidityValue.replaceAll("\"", "");
                jsonHumidityValue = jsonHumidityValue.replaceAll("}", "");
                jsonHumidityValue = jsonHumidityValue.replaceAll("]", "");

                var iterator = humidityArray.values();
                var dateArray = [];
                var humidityValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanHumidity = JSON.stringify(Object.values(elements));
                    cleanHumidity = cleanHumidity.split(":").pop();
                    cleanHumidity = cleanHumidity.replaceAll("\"", "");
                    cleanHumidity = cleanHumidity.replaceAll("}", "");
                    cleanHumidity = cleanHumidity.replaceAll("]", "");
                    humidityValueArray.push(cleanHumidity);
                }

                document.getElementById('humidityChartContainer').innerHTML = "";
                document.getElementById('humidityChartContainer').innerHTML = "<canvas id=\"humidityChart\"></canvas>";
                new Chart("humidityChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: humidityValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 20.00, max: 90.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectCarbonDioxideOption() {
            var selectedAirDate = document.getElementById("airQualityDateArray").value;
            let selectedDayAir = 'MQ135/CO2/' + selectedAirDate;
            firebase.database().ref(selectedDayAir).on('value', (snap) => {
                var airQualityStr = snap.val();
                var airQualityArray = [];

                Object.keys(airQualityStr).forEach((key) => {
                    airQualityArray.push({[key]: airQualityStr[key]});
                });

                var latestAirQuality = airQualityArray[airQualityArray.length - 1];
                var airQualityValue = Object.values(latestAirQuality);
                var jsonAirQualityValue = JSON.stringify(airQualityValue);

                jsonAirQualityValue = jsonAirQualityValue.split(":").pop();
                jsonAirQualityValue = jsonAirQualityValue.replaceAll("\"", "");
                jsonAirQualityValue = jsonAirQualityValue.replaceAll("}", "");
                jsonAirQualityValue = jsonAirQualityValue.replaceAll("]", "");

                var iterator = airQualityArray.values();
                var dateArray = [];
                var airValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanAirQuality = JSON.stringify(Object.values(elements));
                    cleanAirQuality = cleanAirQuality.split(":").pop();
                    cleanAirQuality = cleanAirQuality.replaceAll("\"", "");
                    cleanAirQuality = cleanAirQuality.replaceAll("}", "");
                    cleanAirQuality = cleanAirQuality.replaceAll("]", "");
                    airValueArray.push(cleanAirQuality);
                }

                document.getElementById("airQualityChartContainer").innerHTML = "";
                document.getElementById('airQualityChartContainer').innerHTML = "<canvas id=\"airQualityChart\"></canvas>";
                new Chart("airQualityChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: airValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectSmokeOption() {
            var selectedSmokeDate = document.getElementById("SmokeDateArray").value;
            let selectedDaySmoke = 'MQ2/Smoke/' + selectedSmokeDate;
            firebase.database().ref(selectedDaySmoke).on('value', (snap) => {
                var smokeStr = snap.val();
                var smokeArray = [];

                Object.keys(smokeStr).forEach((key) => {
                    smokeArray.push({[key]: smokeStr[key]});
                });

                var latestSmoke = smokeArray[smokeArray.length - 1];
                var smokeValue = Object.values(latestSmoke);
                var jsonSmokeValue = JSON.stringify(smokeValue);

                jsonSmokeValue = jsonSmokeValue.split(":").pop();
                jsonSmokeValue = jsonSmokeValue.replaceAll("\"", "");
                jsonSmokeValue = jsonSmokeValue.replaceAll("}", "");
                jsonSmokeValue = jsonSmokeValue.replaceAll("]", "");

                var iterator = smokeArray.values();
                var dateArray = [];
                var smokeValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanSmoke = JSON.stringify(Object.values(elements));
                    cleanSmoke = cleanSmoke.split(":").pop();
                    cleanSmoke = cleanSmoke.replaceAll("\"", "");
                    cleanSmoke = cleanSmoke.replaceAll("}", "");
                    cleanSmoke = cleanSmoke.replaceAll("]", "");
                    smokeValueArray.push(cleanSmoke);
                }

                document.getElementById("smokeChartContainer").innerHTML = "";
                document.getElementById('smokeChartContainer').innerHTML = "<canvas id=\"smokeChart\"></canvas>";
                new Chart("smokeChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: smokeValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectLPGOption() {
            var selectedLPGDate = document.getElementById("LPGDateArray").value;
            let selectedDayLPG = 'MQ2/LPG/' + selectedLPGDate;
            firebase.database().ref(selectedDayLPG).on('value', (snap) => {
                var LPGStr = snap.val();
                var LPGArray = [];

                Object.keys(LPGStr).forEach((key) => {
                    LPGArray.push({[key]: LPGStr[key]});
                });

                var latestLPG = LPGArray[LPGArray.length - 1];
                var LPGValue = Object.values(latestLPG);
                var jsonLPGValue = JSON.stringify(LPGValue);

                jsonLPGValue = jsonLPGValue.split(":").pop();
                jsonLPGValue = jsonLPGValue.replaceAll("\"", "");
                jsonLPGValue = jsonLPGValue.replaceAll("}", "");
                jsonLPGValue = jsonLPGValue.replaceAll("]", "");

                var iterator = LPGArray.values();
                var dateArray = [];
                var LPGValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanLPG = JSON.stringify(Object.values(elements));
                    cleanLPG = cleanLPG.split(":").pop();
                    cleanLPG = cleanLPG.replaceAll("\"", "");
                    cleanLPG = cleanLPG.replaceAll("}", "");
                    cleanLPG = cleanLPG.replaceAll("]", "");
                    LPGValueArray.push(cleanLPG);
                }

                document.getElementById("LPGChartContainer").innerHTML = "";
                document.getElementById('LPGChartContainer').innerHTML = "<canvas id=\"LPGChart\"></canvas>";
                new Chart("LPGChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: LPGValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 5000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectCOOption() {
            var selectedCODate = document.getElementById("CODateArray").value;
            let selectedDayCO = 'MQ2/CO/' + selectedCODate;
            firebase.database().ref(selectedDayCO).on('value', (snap) => {
                var COStr = snap.val();
                var COArray = [];

                Object.keys(COStr).forEach((key) => {
                    COArray.push({[key]: COStr[key]});
                });

                var latestCO = COArray[COArray.length - 1];
                var COValue = Object.values(latestCO);
                var jsonCOValue = JSON.stringify(COValue);

                jsonCOValue = jsonCOValue.split(":").pop();
                jsonCOValue = jsonCOValue.replaceAll("\"", "");
                jsonCOValue = jsonCOValue.replaceAll("}", "");
                jsonCOValue = jsonCOValue.replaceAll("]", "");

                var iterator = COArray.values();
                var dateArray = [];
                var COValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanCO = JSON.stringify(Object.values(elements));
                    cleanCO = cleanCO.split(":").pop();
                    cleanCO = cleanCO.replaceAll("\"", "");
                    cleanCO = cleanCO.replaceAll("}", "");
                    cleanCO = cleanCO.replaceAll("]", "");
                    COValueArray.push(cleanCO);
                }

                document.getElementById("COChartContainer").innerHTML = "";
                document.getElementById('COChartContainer').innerHTML = "<canvas id=\"COChart\"></canvas>";
                new Chart("COChart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: COValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectPM25Option() {
            var selectedPM25Date = document.getElementById("PM25DateArray").value;
            let selectedDayPM25 = 'DSM501A/PM25/' + selectedPM25Date;
            firebase.database().ref(selectedDayPM25).on('value', (snap) => {
                var PM25Str = snap.val();
                var PM25Array = [];

                Object.keys(PM25Str).forEach((key) => {
                    PM25Array.push({[key]: PM25Str[key]});
                });

                var latestPM25 = PM25Array[PM25Array.length - 1];
                var PM25Value = Object.values(latestPM25);
                var jsonPM25Value = JSON.stringify(PM25Value);

                jsonPM25Value = jsonPM25Value.split(":").pop();
                jsonPM25Value = jsonPM25Value.replaceAll("\"", "");
                jsonPM25Value = jsonPM25Value.replaceAll("}", "");
                jsonPM25Value = jsonPM25Value.replaceAll("]", "");

                var iterator = PM25Array.values();
                var dateArray = [];
                var PM25ValueArray = [];
                for (let elements of iterator) {
                    dateArray.push(Object.keys(elements).toString());
                    let cleanPM25 = JSON.stringify(Object.values(elements));
                    cleanPM25 = cleanPM25.split(":").pop();
                    cleanPM25 = cleanPM25.replaceAll("\"", "");
                    cleanPM25 = cleanPM25.replaceAll("}", "");
                    cleanPM25 = cleanPM25.replaceAll("]", "");
                    PM25ValueArray.push(cleanPM25);
                }

                document.getElementById("PM25ChartContainer").innerHTML = "";
                document.getElementById('PM25ChartContainer').innerHTML = "<canvas id=\"PM25Chart\"></canvas>";
                new Chart("PM25Chart", {
                    type: "line",
                    data: {
                        labels: dateArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: PM25ValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 50.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', async function () {
                var temperatureModal = document.getElementById("temperatureModal");
                var humidityModal = document.getElementById("humidityModal");
                var airQualityModal = document.getElementById("airQualityModal");
                var PM25Modal = document.getElementById("PM25Modal");

                var temperatureBtn = document.getElementById("temperatureIndicator");
                var humidityBtn = document.getElementById("humidityIndicator");
                var airQualityBtn = document.getElementById("airQualityIndicator");
                var PM25Btn = document.getElementById("PM25Indicator");

                var smokeModal = document.getElementById("smokeModal");
                var lpgModal = document.getElementById("lpgModal");
                var coModal = document.getElementById("coModal");

                var smokeBtn = document.getElementById("smokeIndicator");
                var lpgBtn = document.getElementById("lpgIndicator");
                var coBtn = document.getElementById("coIndicator");

                var span1 = document.getElementsByClassName("close")[0];
                var span2 = document.getElementsByClassName("close")[1];
                var span3 = document.getElementsByClassName("close")[2];
                var span4 = document.getElementsByClassName("close")[3];
                var span5 = document.getElementsByClassName("close")[4];
                var span6 = document.getElementsByClassName("close")[5];
                var span7 = document.getElementsByClassName("close")[6];

                // show modal after clicking data indicator
                temperatureBtn.onclick = function () {
                    temperatureModal.style.display = "block";
                }

                humidityBtn.onclick = function () {
                    humidityModal.style.display = "block";
                }

                airQualityBtn.onclick = function () {
                    airQualityModal.style.display = "block";
                }

                PM25Btn.onclick = function () {
                    PM25Modal.style.display = "block";
                }

                smokeBtn.onclick = function () {
                    smokeModal.style.display = "block";
                }

                lpgBtn.onclick = function () {
                    lpgModal.style.display = "block";
                }

                coBtn.onclick = function () {
                    coModal.style.display = "block";
                }

                // close modal after clicking "x" (close) modal button
                span1.onclick = function () {
                    temperatureModal.style.display = "none";
                }

                span2.onclick = function () {
                    humidityModal.style.display = "none";
                }

                span3.onclick = function () {
                    airQualityModal.style.display = "none";
                }

                span4.onclick = function () {
                    smokeModal.style.display = "none";
                }

                span5.onclick = function () {
                    lpgModal.style.display = "none";
                }

                span6.onclick = function () {
                    coModal.style.display = "none";
                }

                span7.onclick = function () {
                    PM25Modal.style.display = "none";
                }

                // close modal after clicking outside the modal
                window.onclick = function (event) {
                    if (event.target === temperatureModal) {
                        temperatureModal.style.display = "none";
                    }
                    if (event.target === humidityModal) {
                        humidityModal.style.display = "none";
                    }
                    if (event.target === airQualityModal) {
                        airQualityModal.style.display = "none";
                    }
                    if (event.target === PM25Modal) {
                        PM25Modal.style.display = "none";
                    }
                    if (event.target === smokeModal) {
                        smokeModal.style.display = "none";
                    }
                    if (event.target === coModal) {
                        coModal.style.display = "none";
                    }
                    if (event.target === lpgModal) {
                        lpgModal.style.display = "none";
                    }
                }

                document.querySelector('#load');

                var temperatureDays;
                var humidityDays;
                var airDays;
                var PM25Days;
                var LPGDays;
                var smokeDays;
                var CODays;

                var date;
                var previousDateCount;
                var currentDateCount;

                var temperatureDateSelect = document.getElementById("temperatureDateArray");
                var humidityDateSelect = document.getElementById("humidityDateArray");
                var CO2DateSelect = document.getElementById("airQualityDateArray");
                var smokeDateSelect = document.getElementById("SmokeDateArray");
                var LPGDateSelect = document.getElementById("LPGDateArray");
                var CODateSelect = document.getElementById("CODateArray");
                var PM25DateSelect = document.getElementById("PM25DateArray");

                var firebaseDays = document.getElementById("firebaseDateArray");

                await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                    temperatureDays = snap.val();
                    temperatureDays = Object.keys(temperatureDays);
                    temperatureDays.sort(dateComparison);
                    for (var i = 0; i < temperatureDays.length; i++) {
                        var option = temperatureDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        temperatureDateSelect.prepend(element);
                    }
                    document.getElementById("temperatureDateArray").selectedIndex = "0";
                });


                await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                    firebaseDays = snap.val();
                    firebaseDays = Object.keys(firebaseDays);
                    firebaseDays.sort(dateComparison);
                    previousDateCount = firebaseDays.length;
                });

                async function loop10SecondDays() {
                    await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                        firebaseDays = snap.val();
                        firebaseDays = Object.keys(firebaseDays);
                        firebaseDays.sort(dateComparison);
                        console.log(firebaseDays);
                        date = firebaseDays[firebaseDays.length - 1];
                    });
                }

                console.log(previousDateCount);

                async function tallyDays() {
                    currentDateCount = firebaseDays.length;
                    if (previousDateCount !== currentDateCount) {
                        location.reload();
                    }
                }

                await loop10SecondDays();
                setInterval(function () {
                    loop10SecondDays();
                    tallyDays();
                }, 10000);

                let currentDayTemperature = 'DHT11/Temperature/' + date;
                let currentDayHumidity = 'DHT11/Humidity/' + date;
                let currentDayAirQuality = 'MQ135/CO2/' + date;
                let currentDaySmoke = 'MQ2/Smoke/' + date;
                let currentDayLPG = 'MQ2/LPG/' + date;
                let currentDayCO = 'MQ2/CO/' + date;
                let currentDayPM25 = 'DSM501A/PM25/' + date;

                var timeStr;

                firebase.database().ref(currentDayTemperature).on('value', (snap) => {
                    var temperatureStr = snap.val();
                    var temperatureArray = [];

                    Object.keys(temperatureStr).forEach((key) => {
                        temperatureArray.push({[key]: temperatureStr[key]});
                    });

                    var latestTemperature = temperatureArray[temperatureArray.length - 1];
                    timeStr = Object.keys(latestTemperature);
                    var temperatureValue = Object.values(latestTemperature);
                    var jsonTemperatureValue = JSON.stringify(temperatureValue);

                    jsonTemperatureValue = jsonTemperatureValue.split(":").pop();
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("\"", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("}", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("]", "");

                    if (jsonTemperatureValue > 26) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#128293';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonTemperatureValue >= 23 && jsonTemperatureValue <= 26) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#127777';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#4CBB17";
                    }
                    if (jsonTemperatureValue <= 22) {
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#x2744';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#71A6D1";
                    }

                    document.getElementById('latestTemperature').innerHTML = jsonTemperatureValue;
                    document.getElementById('currentDate').innerHTML = "Date: " + date;
                    document.getElementById('currentTime').innerHTML = "Time: " + timeStr;

                    var iterator = temperatureArray.values();

                    var dateArray = [];
                    var temperatureValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanTemperature = JSON.stringify(Object.values(elements));
                        cleanTemperature = cleanTemperature.split(":").pop();
                        cleanTemperature = cleanTemperature.replaceAll("\"", "");
                        cleanTemperature = cleanTemperature.replaceAll("}", "");
                        cleanTemperature = cleanTemperature.replaceAll("]", "");
                        temperatureValueArray.push(cleanTemperature);
                    }

                    if (document.getElementById("temperatureDateArray").value === date) {
                        new Chart("temperatureChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: temperatureValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 10.00, max: 45.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('DHT11/Humidity/').once('value', (snap) => {
                    humidityDays = snap.val();
                    humidityDays = Object.keys(humidityDays);
                    humidityDays.sort(dateComparison);
                    for (var i = 0; i < humidityDays.length; i++) {
                        var option = humidityDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        humidityDateSelect.prepend(element);
                    }
                    document.getElementById("humidityDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayHumidity).on('value', (snap) => {
                    var humidityStr = snap.val();
                    var humidityArray = [];
                    Object.keys(humidityStr).forEach((key) => {
                        humidityArray.push({[key]: humidityStr[key]});
                    });

                    var latestHumidity = humidityArray[humidityArray.length - 1];
                    var humidityValue = Object.values(latestHumidity);
                    var jsonHumidityValue = JSON.stringify(humidityValue);

                    jsonHumidityValue = jsonHumidityValue.split(":").pop();
                    jsonHumidityValue = jsonHumidityValue.replaceAll("\"", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("}", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("]", "");

                    if (jsonHumidityValue >= 80) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128543;';
                        // worried 128543
                        document.getElementById("humidityIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonHumidityValue >= 60 && jsonHumidityValue < 80) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128577;';
                        // frown 128577
                        document.getElementById("humidityIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonHumidityValue >= 0 && jsonHumidityValue < 60) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128516;';
                        //happy 128516
                        document.getElementById("humidityIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestHumidity').innerHTML = jsonHumidityValue;
                    var iterator = humidityArray.values();

                    var dateArray = [];
                    var humidityValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanHumidity = JSON.stringify(Object.values(elements));
                        cleanHumidity = cleanHumidity.split(":").pop();
                        cleanHumidity = cleanHumidity.replaceAll("\"", "");
                        cleanHumidity = cleanHumidity.replaceAll("}", "");
                        cleanHumidity = cleanHumidity.replaceAll("]", "");
                        humidityValueArray.push(cleanHumidity);
                    }
                    if (document.getElementById("humidityDateArray").value === date) {
                        new Chart("humidityChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: humidityValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 20.00, max: 90.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ135/CO2/').once('value', (snap) => {
                    airDays = snap.val();
                    airDays = Object.keys(airDays);
                    airDays.sort(dateComparison);
                    for (var i = 0; i < airDays.length; i++) {
                        var option = airDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        CO2DateSelect.prepend(element);
                    }
                    document.getElementById("airQualityDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayAirQuality).on('value', (snap) => {
                    var airQualityStr = snap.val();
                    var airQualityArray = [];
                    Object.keys(airQualityStr).forEach((key) => {
                        airQualityArray.push({[key]: airQualityStr[key]});
                    });

                    var latestAirQuality = airQualityArray[airQualityArray.length - 1];
                    var airQualityValue = Object.values(latestAirQuality);
                    var jsonAirQualityValue = JSON.stringify(airQualityValue);

                    jsonAirQualityValue = jsonAirQualityValue.split(":").pop();
                    jsonAirQualityValue = jsonAirQualityValue.replaceAll("\"", "");
                    jsonAirQualityValue = jsonAirQualityValue.replaceAll("}", "");
                    jsonAirQualityValue = jsonAirQualityValue.replaceAll("]", "");

                    if (jsonAirQualityValue >= 800) {
                        jsonAirQualityValue = jsonAirQualityValue + 'ppm' + '&#128128;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonAirQualityValue >= 600 && jsonAirQualityValue <= 799) {
                        jsonAirQualityValue = jsonAirQualityValue + 'ppm' + '&#128567;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonAirQualityValue <= 599) {
                        jsonAirQualityValue = jsonAirQualityValue + 'ppm' + '&#128516;';
                        document.getElementById("airQualityIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestAirQuality').innerHTML = jsonAirQualityValue;
                    var iterator = airQualityArray.values();

                    var dateArray = [];
                    var airQualityValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanAirQuality = JSON.stringify(Object.values(elements));
                        cleanAirQuality = cleanAirQuality.split(":").pop();
                        cleanAirQuality = cleanAirQuality.replaceAll("\"", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("}", "");
                        cleanAirQuality = cleanAirQuality.replaceAll("]", "");
                        airQualityValueArray.push(cleanAirQuality);
                    }
                    if (document.getElementById("airQualityDateArray").value === date) {
                        new Chart("airQualityChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: airQualityValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('DSM501A/PM25/').once('value', (snap) => {
                    PM25Days = snap.val();
                    PM25Days = Object.keys(PM25Days);
                    PM25Days.sort(dateComparison);
                    for (var i = 0; i < PM25Days.length; i++) {
                        var option = PM25Days[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        PM25DateSelect.prepend(element);
                    }
                    document.getElementById("PM25DateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayPM25).on('value', (snap) => {
                    var PM25Str = snap.val();
                    var PM25Array = [];
                    Object.keys(PM25Str).forEach((key) => {
                        PM25Array.push({[key]: PM25Str[key]});
                    });

                    var latestPM25 = PM25Array[PM25Array.length - 1];
                    var PM25Value = Object.values(latestPM25);
                    var jsonPM25Value = JSON.stringify(PM25Value);

                    jsonPM25Value = jsonPM25Value.split(":").pop();
                    jsonPM25Value = jsonPM25Value.replaceAll("\"", "");
                    jsonPM25Value = jsonPM25Value.replaceAll("}", "");
                    jsonPM25Value = jsonPM25Value.replaceAll("]", "");

                    if (jsonPM25Value >= 8) {
                        jsonPM25Value = jsonPM25Value + 'ppm' + '&#128128;';
                        document.getElementById("PM25Indicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonPM25Value >= 5 && jsonPM25Value <= 7) {
                        jsonPM25Value = jsonPM25Value + 'ppm' + '&#128567;';
                        document.getElementById("PM25Indicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonPM25Value <= 4) {
                        jsonPM25Value = jsonPM25Value + 'ppm' + '&#128516;';
                        document.getElementById("PM25Indicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestPM25').innerHTML = jsonPM25Value;

                    var iterator = PM25Array.values();
                    var dateArray = [];
                    var PM25ValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanPM25 = JSON.stringify(Object.values(elements));
                        cleanPM25 = cleanPM25.split(":").pop();
                        cleanPM25 = cleanPM25.replaceAll("\"", "");
                        cleanPM25 = cleanPM25.replaceAll("}", "");
                        cleanPM25 = cleanPM25.replaceAll("]", "");
                        PM25ValueArray.push(cleanPM25);
                    }
                    if (document.getElementById("PM25DateArray").value === date) {
                        new Chart("PM25Chart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: PM25ValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 50.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ2/Smoke/').once('value', (snap) => {
                    smokeDays = snap.val();
                    smokeDays = Object.keys(smokeDays);
                    smokeDays.sort(dateComparison);

                    for (var i = 0; i < smokeDays.length; i++) {
                        var option = smokeDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        smokeDateSelect.prepend(element);
                    }
                    document.getElementById("SmokeDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDaySmoke).on('value', (snap) => {
                    var smokeStr = snap.val();
                    var smokeArray = [];
                    Object.keys(smokeStr).forEach((key) => {
                        smokeArray.push({[key]: smokeStr[key]});
                    });

                    var latestSmoke = smokeArray[smokeArray.length - 1];
                    var smokeValue = Object.values(latestSmoke);
                    var jsonSmokeValue = JSON.stringify(smokeValue);

                    jsonSmokeValue = jsonSmokeValue.split(":").pop();
                    jsonSmokeValue = jsonSmokeValue.replaceAll("\"", "");
                    jsonSmokeValue = jsonSmokeValue.replaceAll("}", "");
                    jsonSmokeValue = jsonSmokeValue.replaceAll("]", "");

                    if (jsonSmokeValue >= 800) {
                        jsonSmokeValue = jsonSmokeValue + 'ppm' + '&#128128;';
                        document.getElementById("smokeIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonSmokeValue >= 400 && jsonSmokeValue < 800) {
                        jsonSmokeValue = jsonSmokeValue + 'ppm' + '&#128567;';
                        document.getElementById("smokeIndicator").style.backgroundColor = "	#FFA500";
                    }
                    if (jsonSmokeValue < 400) {
                        jsonSmokeValue = jsonSmokeValue + 'ppm' + '&#128516;';
                        document.getElementById("smokeIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestSmoke').innerHTML = jsonSmokeValue;
                    var iterator = smokeArray.values();

                    var dateArray = [];
                    var smokeValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanSmoke = JSON.stringify(Object.values(elements));
                        cleanSmoke = cleanSmoke.split(":").pop();
                        cleanSmoke = cleanSmoke.replaceAll("\"", "");
                        cleanSmoke = cleanSmoke.replaceAll("}", "");
                        cleanSmoke = cleanSmoke.replaceAll("]", "");
                        smokeValueArray.push(cleanSmoke);
                    }

                    if (document.getElementById("SmokeDateArray").value === date) {
                        new Chart("smokeChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: smokeValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ2/LPG/').once('value', (snap) => {
                    LPGDays = snap.val();
                    LPGDays = Object.keys(LPGDays);
                    LPGDays.sort(dateComparison);

                    for (var i = 0; i < LPGDays.length; i++) {
                        var option = LPGDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        LPGDateSelect.prepend(element);
                    }
                    document.getElementById("LPGDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayLPG).on('value', (snap) => {
                    var LPGStr = snap.val();
                    var LPGArray = [];
                    Object.keys(LPGStr).forEach((key) => {
                        LPGArray.push({[key]: LPGStr[key]});
                    });

                    var latestLPG = LPGArray[LPGArray.length - 1];
                    var LPGValue = Object.values(latestLPG);
                    var jsonLPGValue = JSON.stringify(LPGValue);

                    jsonLPGValue = jsonLPGValue.split(":").pop();
                    jsonLPGValue = jsonLPGValue.replaceAll("\"", "");
                    jsonLPGValue = jsonLPGValue.replaceAll("}", "");
                    jsonLPGValue = jsonLPGValue.replaceAll("]", "");

                    if (jsonLPGValue >= 1000) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128128;';
                        document.getElementById("lpgIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonLPGValue >= 500 && jsonLPGValue < 1000) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128567;';
                        document.getElementById("lpgIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonLPGValue < 500) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128516;';
                        document.getElementById("lpgIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestLPG').innerHTML = jsonLPGValue;
                    var iterator = LPGArray.values();


                    var dateArray = [];
                    var LPGValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanLPG = JSON.stringify(Object.values(elements));
                        cleanLPG = cleanLPG.split(":").pop();
                        cleanLPG = cleanLPG.replaceAll("\"", "");
                        cleanLPG = cleanLPG.replaceAll("}", "");
                        cleanLPG = cleanLPG.replaceAll("]", "");
                        LPGValueArray.push(cleanLPG);
                    }
                    if (document.getElementById("LPGDateArray").value === date) {
                        new Chart("LPGChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: LPGValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 5000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ2/CO/').once('value', (snap) => {
                    CODays = snap.val();
                    CODays = Object.keys(CODays);
                    CODays.sort(dateComparison);

                    for (var i = 0; i < CODays.length; i++) {
                        var option = CODays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        CODateSelect.prepend(element);
                    }
                    document.getElementById("CODateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayCO).on('value', (snap) => {
                    var COStr = snap.val();
                    var COArray = [];
                    Object.keys(COStr).forEach((key) => {
                        COArray.push({[key]: COStr[key]});
                    });

                    var latestCO = COArray[COArray.length - 1];
                    var COValue = Object.values(latestCO);
                    var jsonCOValue = JSON.stringify(COValue);

                    jsonCOValue = jsonCOValue.split(":").pop();
                    jsonCOValue = jsonCOValue.replaceAll("\"", "");
                    jsonCOValue = jsonCOValue.replaceAll("}", "");
                    jsonCOValue = jsonCOValue.replaceAll("]", "");

                    if (jsonCOValue >= 800) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128128;';
                        document.getElementById("coIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonCOValue >= 400 && jsonCOValue < 800) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128567;';
                        document.getElementById("coIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonCOValue < 400) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128516;';
                        document.getElementById("coIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestCO').innerHTML = jsonCOValue;
                    var iterator = COArray.values();

                    var dateArray = [];
                    var COValueArray = [];
                    for (let elements of iterator) {
                        dateArray.push(Object.keys(elements).toString());
                        let cleanCO = JSON.stringify(Object.values(elements));
                        cleanCO = cleanCO.split(":").pop();
                        cleanCO = cleanCO.replaceAll("\"", "");
                        cleanCO = cleanCO.replaceAll("}", "");
                        cleanCO = cleanCO.replaceAll("]", "");
                        COValueArray.push(cleanCO);
                    }
                    if (document.getElementById("CODateArray").value === date) {
                        new Chart("COChart", {
                            type: "line",
                            data: {
                                labels: dateArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: COValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });
            }
        );
    </script>
</div>
</body>
</html>