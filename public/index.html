<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <!-- desktop view on all screen sizes -->
    <meta name="viewport" content="width=device-width, initial-scale=0.1">
    <title>Air Quality Monitor Dashboard</title>

    <script defer src="/__/firebase/9.8.4/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/9.8.4/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<style>
    th {
        color: #000000;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        padding-top: 100px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 50%;
    }

    .modal-header {
        padding: 2px 16px;
        background-color: #23408e;
        color: white;
    }

    .close {
        color: white;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    body {
        background-image: url(https://img.freepik.com/premium-vector/background-white-elegant-texture_23-2148438404.jpg?w=2000);
    }

    canvas {
        max-height: 700px;
    }

    select {
        margin-bottom: 15px;
    }
</style>

<body>
<div class="container">
    <div class="row" style="text-align: center; padding: 30px 0;">
        <div class="col-md-3"></div>
        <div class="col-md-3">
            <h3 id="currentDate"></h3>
        </div>
        <div class="col-md-3">
            <h3 id="currentTime"></h3>
        </div>
        <div class="col-md-3"></div>
    </div>

    <!-- hidden firebase (temperature) date drop-down menu (used for timed refresh array purposes only) -->
    <select hidden id="firebaseDateArray"></select>

    <!-- modal for temperature dashboard -->
    <div id="temperatureModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Temperature Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <!-- temperature date drop-down menu -->
                <label for="temperatureDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="temperatureDateArray"
                        onchange="selectTemperatureOption()"></select>
                <!-- temperature data chart -->
                <div id="temperatureChartContainer">
                    <canvas id="temperatureChart"></canvas>
                </div>
                <span style="color: #00AEEF">< 23&#8451: Low Temperature &#129398;</span>
                <br>
                <!--                <span style="color: #4CBB17">23&#8451 - 26&#8451: Recommended Indoor Temperature &#127777;</span>-->
                <span style="color: #4CBB17">23&#8451 - 26&#8451: Recommended Indoor Temperature &#128516;</span>
                <br>
                <!--                <span style="color: #bd1816">> 26&#8451: High Temperature &#128293;</span>-->
                <span style="color: #bd1816">> 26&#8451: High Temperature &#129397;</span>

            </div>
        </div>
    </div>

    <!--    modal for humidity dashboard-->
    <div id="humidityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Humidity Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="humidityDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="humidityDateArray"
                        onchange="selectHumidityOption()"></select>
                <div id="humidityChartContainer">
                    <canvas id="humidityChart"></canvas>
                </div>
                <span style="color: #4CBB17">0% - 59%: Low Risk of Mold Growth &#128516;</span>
                <br>
                <span style="color: #FFA500">60% - 79%: Risk of Mold Growth &#128577;</span>
                <br>
                <span style="color: #bd1816">80% - 100%: High Risk of Mold Growth &#128543;</span>
            </div>
        </div>
    </div>

    <!--    modal for alcohol dashboard-->
    <div id="alcoholModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Alcohol Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="alcoholDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="alcoholDateArray"
                        onchange="selectAlcoholOption()"></select>
                <div id="alcoholChartContainer">
                    <canvas id="alcoholChart"></canvas>
                </div>
                <span style="color: #4CBB17">< 1000ppm: Safe Levels of CO2 &#128516;</span>
                <br>
                <span style="color: #FFA500">1000ppm - 5000ppm: Permissible Levels of CO2 &#128577; (OSHA 8-hour Permissible Exposure Limit: 5000ppm)</span>
                <br>
                <span style="color: #bd1816">5001ppm - 39999ppm: Uncomfortable Levels of CO2 &#128567;</span>
                <br>
                <span style="color: #000000">>= 40000ppm: Hazardous Levels of CO2 &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for ammonia dashboard-->
    <div id="ammoniaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ammonia Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="ammoniaDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="ammoniaDateArray"
                        onchange="selectAmmoniaOption()"></select>
                <div id="ammoniaChartContainer">
                    <canvas id="ammoniaChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 400ppm = Safe Levels of Smoke &#128516;</span>
                <br>
                <span style="color: #FFA500">400ppm - 799ppm = Alarming Levels of Smoke &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of Smoke &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for acetone dashboard-->
    <div id="acetoneModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Acetone Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="acetoneDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="acetoneDateArray"
                        onchange="selectAcetoneOption()"></select>
                <div id="acetoneChartContainer">
                    <canvas id="acetoneChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 400ppm = Safe Levels of Smoke &#128516;</span>
                <br>
                <span style="color: #FFA500">400ppm - 799ppm = Alarming Levels of Smoke &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of Smoke &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for lpg dashboard-->
    <div id="LPGModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Liquefied Petroleum Gas Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="LPGDateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="LPGDateArray" onchange="selectLPGOption()"></select>
                <div id="LPGChartContainer">
                    <canvas id="LPGChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 500ppm = Safe Levels of LPG &#128516;</span>
                <br>
                <span style="color: #FFA500">500ppm - 999ppm = Alarming Levels of LPG &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 1000ppm = Hazardous Levels of LPG &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for carbon monoxide dashboard-->
    <div id="COModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Carbon Monoxide Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="CODateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="CODateArray" onchange="selectCOOption()"></select>
                <div id="COChartContainer">
                    <canvas id="COChart"></canvas>
                </div>
                <span style="color: #4CBB17">Below 400ppm = Safe Levels of CO &#128516;</span>
                <br>
                <span style="color: #FFA500">400ppm - 799ppm = Alarming Levels of CO &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 800ppm = Hazardous Levels of CO &#128128;</span>
            </div>
        </div>
    </div>

    <!--    modal for pm2.5 particulate dashboard-->
    <div id="PM25Modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>PM2.5 Particulate Dashboard</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <label for="PM25DateArray"></label>
                <select class="btn-secondary dropdown-toggle" id="PM25DateArray" onchange="selectPM25Option()"></select>
                <div id="PM25ChartContainer">
                    <canvas id="PM25Chart"></canvas>
                </div>
                <span style="color: #4CBB17">Below or Equals 4ppm = Safe Levels of PM2.5 Particulate Matter &#128516;</span>
                <br>
                <span style="color: #FFA500">5ppm - 7ppm = Alarming Levels of PM2.5 Particulate Matter &#128567;</span>
                <br>
                <span style="color: #bd1816">Above or Equals 8ppm = Hazardous Levels of PM2.5 Particulate Matter &#128128;</span>
            </div>
        </div>
    </div>

    <div class="row" style="justify-content: space-between;">
        <div id="temperatureIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 3%;">
            <h5 style="color: #fff;">Temperature &#127777;</h5>
            <h1 id="latestTemperature" style="color: #fff;"></h1>
        </div>
        <div id="humidityIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Humidity &#128167;</h5>
            <h1 id="latestHumidity" style="color: #fff;"></h1>
        </div>
        <div id="PM25Indicator" class="col-md-3" style="background-color:
        #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
        box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">PM2.5 Particulate&#128173;</h5>
            <h1 id="latestPM25" style="color: #fff;"></h1>
        </div>
    </div>

    <div class="row mt-5" style="justify-content: space-between;">
        <div id="alcoholIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <!--            <h5 style="color: #fff;">Alcohol &#127866;</h5>-->
            <h5 style="color: #fff;">Alcohol (C<sub>2</sub>H<sub>5</sub>OH)</h5>

            <h1 id="latestAlcohol" style="color: #fff;"></h1>
        </div>
        <div id="ammoniaIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Ammonia (NH<sub>3</sub>)</h5>
<!--            <h5 style="color: #fff;">Ammonia &#128701;</h5>-->
            <h1 id="latestAmmonia" style="color: #fff;"></h1>
        </div>
        <div id="acetoneIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Acetone (C<sub>3</sub>H<sub>6</sub>O)</h5>
            <h1 id="latestAcetone" style="color: #fff;"></h1>
        </div>

    </div>

    <div class="row mt-5" style="justify-content: center;">
        <div id="LPGIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 15%;">
            <!--            <h5 style="color: #fff;">Liquefied Petroleum Gas &#9981;</h5>-->
            <h5 style="color: #fff;">Liquefied Petroleum Gas (C<sub>3</sub>H<sub>8</sub>)</h5>

            <h1 id="latestLPG" style="color: #fff;"></h1>
        </div>
        <div id="COIndicator" class="col-md-3" style="background-color:
          #23408e; text-align: center; padding: 15px 0; border-radius: 30px;
          box-shadow: 5px 5px 5px grey; margin-right: 2%;">
            <h5 style="color: #fff;">Carbon Monoxide (CO)</h5>
            <h1 id="latestCO" style="color: #fff;"></h1>
        </div>

    </div>
    <script>
        // sort(dateComparison) to sort date array from oldest to latest
        function dateComparison(a, b) {
            const date1 = new Date(a)
            const date2 = new Date(b)
            return date1 - date2;
        }

        // obtain historical temperature data after selecting temperature date from drop-down menu
        function selectTemperatureOption() {
            // get selected temperature date
            var selectedTemperatureDate = document.getElementById("temperatureDateArray").value;
            let selectedDayTemperature = 'DHT11/Temperature/' + selectedTemperatureDate;

            // retrieve firebase realtime database data of the selected temperature date
            firebase.database().ref(selectedDayTemperature).on('value', (snap) => {
                var temperatureStr = snap.val();
                var temperatureArray = [];

                // insert retrieved selected temperature date data into array
                Object.keys(temperatureStr).forEach((key) => {
                    temperatureArray.push({[key]: temperatureStr[key]});
                });

                var iterator = temperatureArray.values();
                var timeArray = [];
                var temperatureValueArray = [];
                for (let elements of iterator) {
                    // insert selected temperature date data array element keys (time) into time array
                    timeArray.push(Object.keys(elements).toString());
                    // json converted to string for the selected temperature date data array element value (temperature)
                    let cleanTemperature = JSON.stringify(Object.values(elements));
                    // remove unnecessary string data and be left with only actual temperature value
                    cleanTemperature = cleanTemperature.split(":").pop();
                    cleanTemperature = cleanTemperature.replaceAll("\"", "");
                    cleanTemperature = cleanTemperature.replaceAll("}", "");
                    cleanTemperature = cleanTemperature.replaceAll("]", "");
                    // insert actual temperature value into temperature value array
                    temperatureValueArray.push(cleanTemperature);
                }

                // empty and reload the div to prevent other temperature chart data from other days from being shown
                // when hovering over temperature chart data points
                document.getElementById("temperatureChartContainer").innerHTML = "";
                document.getElementById('temperatureChartContainer').innerHTML = "<canvas id=\"temperatureChart\"></canvas>";
                new Chart("temperatureChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: temperatureValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 10.00, max: 45.00}}],
                            // limit x axis to 24 ticks
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectHumidityOption() {
            var selectedHumidityDate = document.getElementById("humidityDateArray").value;
            let selectedDayHumidity = 'DHT11/Humidity/' + selectedHumidityDate;
            firebase.database().ref(selectedDayHumidity).on('value', (snap) => {
                var humidityStr = snap.val();
                var humidityArray = [];

                Object.keys(humidityStr).forEach((key) => {
                    humidityArray.push({[key]: humidityStr[key]});
                });

                var iterator = humidityArray.values();
                var timeArray = [];
                var humidityValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanHumidity = JSON.stringify(Object.values(elements));
                    cleanHumidity = cleanHumidity.split(":").pop();
                    cleanHumidity = cleanHumidity.replaceAll("\"", "");
                    cleanHumidity = cleanHumidity.replaceAll("}", "");
                    cleanHumidity = cleanHumidity.replaceAll("]", "");
                    humidityValueArray.push(cleanHumidity);
                }

                document.getElementById('humidityChartContainer').innerHTML = "";
                document.getElementById('humidityChartContainer').innerHTML = "<canvas id=\"humidityChart\"></canvas>";
                new Chart("humidityChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: humidityValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 100.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectAlcoholOption() {
            var selectedAlcoholDate = document.getElementById("alcoholDateArray").value;
            let selectedDayAlcohol = 'MQ135/Alcohol/' + selectedAlcoholDate;
            firebase.database().ref(selectedDayAlcohol).on('value', (snap) => {
                var alcoholStr = snap.val();
                var alcoholArray = [];

                Object.keys(alcoholStr).forEach((key) => {
                    alcoholArray.push({[key]: alcoholStr[key]});
                });

                var iterator = alcoholArray.values();
                var timeArray = [];
                var alcoholValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanAlcohol = JSON.stringify(Object.values(elements));
                    cleanAlcohol = cleanAlcohol.split(":").pop();
                    cleanAlcohol = cleanAlcohol.replaceAll("\"", "");
                    cleanAlcohol = cleanAlcohol.replaceAll("}", "");
                    cleanAlcohol = cleanAlcohol.replaceAll("]", "");
                    alcoholValueArray.push(cleanAlcohol);
                }

                document.getElementById("alcoholChartContainer").innerHTML = "";
                document.getElementById('alcoholChartContainer').innerHTML = "<canvas id=\"alcoholChart\"></canvas>";
                new Chart("alcoholChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: alcoholValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 40000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectAmmoniaOption() {
            var selectedAmmoniaDate = document.getElementById("ammoniaDateArray").value;
            let selectedDayAmmonia = 'MQ135/Ammonia/' + selectedAmmoniaDate;
            firebase.database().ref(selectedDayAmmonia).on('value', (snap) => {
                var ammoniaStr = snap.val();
                var ammoniaArray = [];

                Object.keys(ammoniaStr).forEach((key) => {
                    ammoniaArray.push({[key]: ammoniaStr[key]});
                });

                var iterator = ammoniaArray.values();
                var timeArray = [];
                var ammoniaValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanAmmonia = JSON.stringify(Object.values(elements));
                    cleanAmmonia = cleanAmmonia.split(":").pop();
                    cleanAmmonia = cleanAmmonia.replaceAll("\"", "");
                    cleanAmmonia = cleanAmmonia.replaceAll("}", "");
                    cleanAmmonia = cleanAmmonia.replaceAll("]", "");
                    ammoniaValueArray.push(cleanAmmonia);
                }

                document.getElementById("ammoniaChartContainer").innerHTML = "";
                document.getElementById('ammoniaChartContainer').innerHTML = "<canvas id=\"ammoniaChart\"></canvas>";
                new Chart("ammoniaChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: ammoniaValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectAcetoneOption() {
            var selectedAcetoneDate = document.getElementById("acetoneDateArray").value;
            let selectedDayAcetone = 'MQ135/Acetone/' + selectedAcetoneDate;
            firebase.database().ref(selectedDayAcetone).on('value', (snap) => {
                var acetoneStr = snap.val();
                var acetoneArray = [];

                Object.keys(acetoneStr).forEach((key) => {
                    acetoneArray.push({[key]: acetoneStr[key]});
                });

                var iterator = acetoneArray.values();
                var timeArray = [];
                var acetoneValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanAcetone = JSON.stringify(Object.values(elements));
                    cleanAcetone = cleanAcetone.split(":").pop();
                    cleanAcetone = cleanAcetone.replaceAll("\"", "");
                    cleanAcetone = cleanAcetone.replaceAll("}", "");
                    cleanAcetone = cleanAcetone.replaceAll("]", "");
                    acetoneValueArray.push(cleanAcetone);
                }

                document.getElementById("acetoneChartContainer").innerHTML = "";
                document.getElementById('acetoneChartContainer').innerHTML = "<canvas id=\"acetoneChart\"></canvas>";
                new Chart("acetoneChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: acetoneValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectLPGOption() {
            var selectedLPGDate = document.getElementById("LPGDateArray").value;
            let selectedDayLPG = 'MQ2/LPG/' + selectedLPGDate;
            firebase.database().ref(selectedDayLPG).on('value', (snap) => {
                var LPGStr = snap.val();
                var LPGArray = [];

                Object.keys(LPGStr).forEach((key) => {
                    LPGArray.push({[key]: LPGStr[key]});
                });

                var iterator = LPGArray.values();
                var timeArray = [];
                var LPGValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanLPG = JSON.stringify(Object.values(elements));
                    cleanLPG = cleanLPG.split(":").pop();
                    cleanLPG = cleanLPG.replaceAll("\"", "");
                    cleanLPG = cleanLPG.replaceAll("}", "");
                    cleanLPG = cleanLPG.replaceAll("]", "");
                    LPGValueArray.push(cleanLPG);
                }

                document.getElementById("LPGChartContainer").innerHTML = "";
                document.getElementById('LPGChartContainer').innerHTML = "<canvas id=\"LPGChart\"></canvas>";
                new Chart("LPGChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: LPGValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 5000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectCOOption() {
            var selectedCODate = document.getElementById("CODateArray").value;
            let selectedDayCO = 'MQ2/CO/' + selectedCODate;
            firebase.database().ref(selectedDayCO).on('value', (snap) => {
                var COStr = snap.val();
                var COArray = [];

                Object.keys(COStr).forEach((key) => {
                    COArray.push({[key]: COStr[key]});
                });

                var iterator = COArray.values();
                var timeArray = [];
                var COValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanCO = JSON.stringify(Object.values(elements));
                    cleanCO = cleanCO.split(":").pop();
                    cleanCO = cleanCO.replaceAll("\"", "");
                    cleanCO = cleanCO.replaceAll("}", "");
                    cleanCO = cleanCO.replaceAll("]", "");
                    COValueArray.push(cleanCO);
                }

                document.getElementById("COChartContainer").innerHTML = "";
                document.getElementById('COChartContainer').innerHTML = "<canvas id=\"COChart\"></canvas>";
                new Chart("COChart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: COValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        function selectPM25Option() {
            var selectedPM25Date = document.getElementById("PM25DateArray").value;
            let selectedDayPM25 = 'DSM501A/PM25/' + selectedPM25Date;
            firebase.database().ref(selectedDayPM25).on('value', (snap) => {
                var PM25Str = snap.val();
                var PM25Array = [];

                Object.keys(PM25Str).forEach((key) => {
                    PM25Array.push({[key]: PM25Str[key]});
                });

                var iterator = PM25Array.values();
                var timeArray = [];
                var PM25ValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanPM25 = JSON.stringify(Object.values(elements));
                    cleanPM25 = cleanPM25.split(":").pop();
                    cleanPM25 = cleanPM25.replaceAll("\"", "");
                    cleanPM25 = cleanPM25.replaceAll("}", "");
                    cleanPM25 = cleanPM25.replaceAll("]", "");
                    PM25ValueArray.push(cleanPM25);
                }

                document.getElementById("PM25ChartContainer").innerHTML = "";
                document.getElementById('PM25ChartContainer').innerHTML = "<canvas id=\"PM25Chart\"></canvas>";
                new Chart("PM25Chart", {
                    type: "line",
                    data: {
                        labels: timeArray,
                        datasets: [{
                            fill: false,
                            lineTension: 0,
                            backgroundColor: "rgba(0,0,255,1.0)",
                            borderColor: "rgba(0,0,255,0.1)",
                            data: PM25ValueArray
                        }]
                    },
                    options: {
                        legend: {display: false},
                        scales: {
                            yAxes: [{ticks: {min: 0.00, max: 50.00}}],
                            xAxes: [{
                                ticks: {
                                    display: true,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }],
                        }
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', async function () {
                var temperatureModal = document.getElementById("temperatureModal");
                var humidityModal = document.getElementById("humidityModal");
                var alcoholModal = document.getElementById("alcoholModal");
                var ammoniaModal = document.getElementById("ammoniaModal");
                var acetoneModal = document.getElementById("acetoneModal");
                var LPGModal = document.getElementById("LPGModal");
                var COModal = document.getElementById("COModal");
                var PM25Modal = document.getElementById("PM25Modal");

                var temperatureBtn = document.getElementById("temperatureIndicator");
                var humidityBtn = document.getElementById("humidityIndicator");
                var alcoholBtn = document.getElementById("alcoholIndicator");
                var ammoniaBtn = document.getElementById("ammoniaIndicator");
                var acetoneBtn = document.getElementById("acetoneIndicator");
                var LPGBtn = document.getElementById("LPGIndicator");
                var COBtn = document.getElementById("COIndicator");
                var PM25Btn = document.getElementById("PM25Indicator");

                var span1 = document.getElementsByClassName("close")[0];
                var span2 = document.getElementsByClassName("close")[1];
                var span3 = document.getElementsByClassName("close")[2];
                var span4 = document.getElementsByClassName("close")[3];
                var span5 = document.getElementsByClassName("close")[4];
                var span6 = document.getElementsByClassName("close")[5];
                var span7 = document.getElementsByClassName("close")[6];
                var span8 = document.getElementsByClassName("close")[7];


            // show modal after clicking data indicator
                temperatureBtn.onclick = function () {
                    temperatureModal.style.display = "block";
                }

                humidityBtn.onclick = function () {
                    humidityModal.style.display = "block";
                }

                alcoholBtn.onclick = function () {
                    alcoholModal.style.display = "block";
                }

                PM25Btn.onclick = function () {
                    PM25Modal.style.display = "block";
                }

                ammoniaBtn.onclick = function () {
                    ammoniaModal.style.display = "block";
                }

                acetoneBtn.onclick = function () {
                    acetoneModal.style.display = "block";
                }

                LPGBtn.onclick = function () {
                    LPGModal.style.display = "block";
                }

                COBtn.onclick = function () {
                    COModal.style.display = "block";
                }

                // close modal after clicking "x" (close) modal button
                span1.onclick = function () {
                    temperatureModal.style.display = "none";
                }

                span2.onclick = function () {
                    humidityModal.style.display = "none";
                }

                span3.onclick = function () {
                    alcoholModal.style.display = "none";
                }

                span4.onclick = function () {
                    ammoniaModal.style.display = "none";
                }

                span5.onclick = function () {
                    acetoneModal.style.display = "none";
                }

                span6.onclick = function () {
                    LPGModal.style.display = "none";
                }

                span7.onclick = function () {
                    COModal.style.display = "none";
                }

                span8.onclick = function () {
                    PM25Modal.style.display = "none";
                }

                // close modal after clicking outside the modal
                window.onclick = function (event) {
                    if (event.target === temperatureModal) {
                        temperatureModal.style.display = "none";
                    }
                    if (event.target === humidityModal) {
                        humidityModal.style.display = "none";
                    }
                    if (event.target === alcoholModal) {
                        alcoholModal.style.display = "none";
                    }
                    if (event.target === PM25Modal) {
                        PM25Modal.style.display = "none";
                    }
                    if (event.target === ammoniaModal) {
                        ammoniaModal.style.display = "none";
                    }
                    if (event.target === acetoneModal) {
                        acetoneModal.style.display = "none";
                    }
                    if (event.target === COModal) {
                        COModal.style.display = "none";
                    }
                    if (event.target === LPGModal) {
                        LPGModal.style.display = "none";
                    }
                }

                document.querySelector('#load');

                var temperatureDays;
                var humidityDays;
                var alcoholDays;
                var PM25Days;
                var LPGDays;
                var ammoniaDays;
                var acetoneDays;
                var CODays;
                var firebaseDays = document.getElementById("firebaseDateArray");

                var temperatureDateSelect = document.getElementById("temperatureDateArray");
                var humidityDateSelect = document.getElementById("humidityDateArray");
                var alcoholDateSelect = document.getElementById("alcoholDateArray");
                var ammoniaDateSelect = document.getElementById("ammoniaDateArray");
                var acetoneDateSelect = document.getElementById("acetoneDateArray");
                var LPGDateSelect = document.getElementById("LPGDateArray");
                var CODateSelect = document.getElementById("CODateArray");
                var PM25DateSelect = document.getElementById("PM25DateArray");

                var date;
                var previousDateCount;
                var currentDateCount;

                // get previous firebaseDays array length
                await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                    firebaseDays = snap.val();
                    firebaseDays = Object.keys(firebaseDays);
                    firebaseDays.sort(dateComparison);
                    previousDateCount = firebaseDays.length;
                });

                // get latest date (final firebaseDays array element)
                async function loop10SecondDays() {
                    await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                        firebaseDays = snap.val();
                        firebaseDays = Object.keys(firebaseDays);
                        firebaseDays.sort(dateComparison);
                        console.log(firebaseDays);
                        date = firebaseDays[firebaseDays.length - 1];
                    });
                }
                console.log(previousDateCount);

                // get current firebaseDays array length
                // check if previous firebaseDays array length is different to current firebaseDays array length
                async function tallyDays() {
                    currentDateCount = firebaseDays.length;
                    if (previousDateCount !== currentDateCount) {
                        // refresh page
                        location.reload();
                    }
                }

                await loop10SecondDays();

                // rerun function every 10 seconds
                setInterval(function () {
                    loop10SecondDays();
                    tallyDays();
                }, 10000);

                // latest data (latest date)
                let currentDayTemperature = 'DHT11/Temperature/' + date;
                let currentDayHumidity = 'DHT11/Humidity/' + date;
                let currentDayAlcohol = 'MQ135/Alcohol/' + date;
                let currentDayAmmonia = 'MQ135/Ammonia/' + date;
                let currentDayAcetone = 'MQ135/Acetone/' + date;
                let currentDayLPG = 'MQ2/LPG/' + date;
                let currentDayCO = 'MQ2/CO/' + date;
                let currentDayPM25 = 'DSM501A/PM25/' + date;

                var timeStr;

                await firebase.database().ref('DHT11/Temperature/').once('value', (snap) => {
                temperatureDays = snap.val();
                temperatureDays = Object.keys(temperatureDays);
                // sort temperature date array from latest to oldest
                temperatureDays.sort(dateComparison);
                // load temperature date data into temperature date drop-down menu
                for (var i = 0; i < temperatureDays.length; i++) {
                    var option = temperatureDays[i];
                    var element = document.createElement("option");
                    element.textContent = option;
                    element.value = option;
                    temperatureDateSelect.prepend(element);
                }
                // select latest temperature date by default
                document.getElementById("temperatureDateArray").selectedIndex = "0";
            });

                firebase.database().ref(currentDayTemperature).on('value', (snap) => {
                    var temperatureStr = snap.val();
                    var temperatureArray = [];

                    // insert retrieved latest temperature data into temperature array
                    Object.keys(temperatureStr).forEach((key) => {
                        temperatureArray.push({[key]: temperatureStr[key]});
                    });

                    // json converted to string for final (latest) temperature array element value
                    var latestTemperature = temperatureArray[temperatureArray.length - 1];
                    var temperatureValue = Object.values(latestTemperature);
                    var jsonTemperatureValue = JSON.stringify(temperatureValue);

                    // remove unnecessary string data and be left with only actual latest temperature value
                    jsonTemperatureValue = jsonTemperatureValue.split(":").pop();
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("\"", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("}", "");
                    jsonTemperatureValue = jsonTemperatureValue.replaceAll("]", "");

                    // compare latest temperature value
                    if (jsonTemperatureValue > 26) {
                        // jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#128293';
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#129397';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonTemperatureValue >= 23 && jsonTemperatureValue <= 26) {
                        // jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#127777';
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#128516';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#4CBB17";
                    }
                    if (jsonTemperatureValue < 23) {
                        // jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#x2744';
                        jsonTemperatureValue = jsonTemperatureValue + '&#8451' + '&#129398';
                        document.getElementById("temperatureIndicator").style.backgroundColor = "#00AEEF";
                    }

                    // latest temperature value
                    document.getElementById('latestTemperature').innerHTML = jsonTemperatureValue;
                    // latest date
                    document.getElementById('currentDate').innerHTML = "Date: " + date;
                    // latest time
                    timeStr = Object.keys(latestTemperature);
                    document.getElementById('currentTime').innerHTML = "Time: " + timeStr;

                    var iterator = temperatureArray.values();
                    var timeArray = [];
                    var temperatureValueArray = [];
                    for (let elements of iterator) {
                        // insert latest temperature array element keys (time) into time array
                        timeArray.push(Object.keys(elements).toString());
                        // json converted to string for the latest temperature array element value (temperature)
                        let cleanTemperature = JSON.stringify(Object.values(elements));
                        // remove unnecessary string data and be left with only actual temperature value
                        cleanTemperature = cleanTemperature.split(":").pop();
                        cleanTemperature = cleanTemperature.replaceAll("\"", "");
                        cleanTemperature = cleanTemperature.replaceAll("}", "");
                        cleanTemperature = cleanTemperature.replaceAll("]", "");
                        // insert actual temperature value into temperature value array
                        temperatureValueArray.push(cleanTemperature);
                    }


                    // load chart if latest date is equal to selected temperature date in drop-down menu
                    if (document.getElementById("temperatureDateArray").value === date) {
                        // empty and reload the div to prevent old temperature chart data from being shown
                        // when hovering over temperature chart data points
                        document.getElementById("temperatureChartContainer").innerHTML = "";
                        document.getElementById('temperatureChartContainer').innerHTML = "<canvas id=\"temperatureChart\"></canvas>";
                        new Chart("temperatureChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: temperatureValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    // 
                                    yAxes: [{ticks: {min: 10.00, max: 45.00}}],
                                    // limit x axis to 24 ticks
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('DHT11/Humidity/').once('value', (snap) => {
                    humidityDays = snap.val();
                    humidityDays = Object.keys(humidityDays);
                    humidityDays.sort(dateComparison);
                    for (var i = 0; i < humidityDays.length; i++) {
                        var option = humidityDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        humidityDateSelect.prepend(element);
                    }
                    document.getElementById("humidityDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayHumidity).on('value', (snap) => {
                    var humidityStr = snap.val();
                    var humidityArray = [];
                    Object.keys(humidityStr).forEach((key) => {
                        humidityArray.push({[key]: humidityStr[key]});
                    });

                    var latestHumidity = humidityArray[humidityArray.length - 1];
                    var humidityValue = Object.values(latestHumidity);
                    var jsonHumidityValue = JSON.stringify(humidityValue);

                    jsonHumidityValue = jsonHumidityValue.split(":").pop();
                    jsonHumidityValue = jsonHumidityValue.replaceAll("\"", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("}", "");
                    jsonHumidityValue = jsonHumidityValue.replaceAll("]", "");

                    if (jsonHumidityValue >= 80) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128543;';
                        // worried 128543
                        document.getElementById("humidityIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonHumidityValue >= 60 && jsonHumidityValue < 80) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128577;';
                        // frown 128577
                        document.getElementById("humidityIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonHumidityValue >= 0 && jsonHumidityValue < 60) {
                        jsonHumidityValue = jsonHumidityValue + "%" + '&#128516;';
                        //happy 128516
                        document.getElementById("humidityIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestHumidity').innerHTML = jsonHumidityValue;
                    var iterator = humidityArray.values();

                    var timeArray = [];
                    var humidityValueArray = [];
                    for (let elements of iterator) {
                        timeArray.push(Object.keys(elements).toString());
                        let cleanHumidity = JSON.stringify(Object.values(elements));
                        cleanHumidity = cleanHumidity.split(":").pop();
                        cleanHumidity = cleanHumidity.replaceAll("\"", "");
                        cleanHumidity = cleanHumidity.replaceAll("}", "");
                        cleanHumidity = cleanHumidity.replaceAll("]", "");
                        humidityValueArray.push(cleanHumidity);
                    }

                    if (document.getElementById("humidityDateArray").value === date) {
                        document.getElementById('humidityChartContainer').innerHTML = "";
                        document.getElementById('humidityChartContainer').innerHTML = "<canvas id=\"humidityChart\"></canvas>";
                        new Chart("humidityChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: humidityValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 100.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ135/Alcohol/').once('value', (snap) => {
                    alcoholDays = snap.val();
                    alcoholDays = Object.keys(alcoholDays);
                    alcoholDays.sort(dateComparison);
                    for (var i = 0; i < alcoholDays.length; i++) {
                        var option = alcoholDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        alcoholDateSelect.prepend(element);
                    }
                    document.getElementById("alcoholDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayAlcohol).on('value', (snap) => {
                    var alcoholStr = snap.val();
                    var alcoholArray = [];
                    Object.keys(alcoholStr).forEach((key) => {
                        alcoholArray.push({[key]: alcoholStr[key]});
                    });

                    var latestAlcohol = alcoholArray[alcoholArray.length - 1];
                    var alcoholValue = Object.values(latestAlcohol);
                    var jsonAlcoholValue = JSON.stringify(alcoholValue);

                    jsonAlcoholValue = jsonAlcoholValue.split(":").pop();
                    jsonAlcoholValue = jsonAlcoholValue.replaceAll("\"", "");
                    jsonAlcoholValue = jsonAlcoholValue.replaceAll("}", "");
                    jsonAlcoholValue = jsonAlcoholValue.replaceAll("]", "");

                    // if (jsonCO2Value >= 800) {
                    //     jsonCO2Value = jsonCO2Value + 'ppm' + '&#128128;';
                    //     document.getElementById("alcoholIndicator").style.backgroundColor = "#bd1816";
                    // }
                    // if (jsonCO2Value >= 600 && jsonCO2Value <= 799) {
                    //     jsonCO2Value = jsonCO2Value + 'ppm' + '&#128567;';
                    //     document.getElementById("alcoholIndicator").style.backgroundColor = "#FFA500";
                    // }
                    // if (jsonCO2Value <= 599) {
                    //     jsonCO2Value = jsonCO2Value + 'ppm' + '&#128516;';
                    //     document.getElementById("alcoholIndicator").style.backgroundColor = "#4CBB17";
                    // }

                    if (jsonAlcoholValue >= 40000) {
                        jsonAlcoholValue = jsonAlcoholValue + 'ppm' + '&#128128;';
                        document.getElementById("alcoholIndicator").style.backgroundColor = "#000000";
                    }
                    if (jsonAlcoholValue > 5000 && jsonAlcoholValue <= 39999) {
                        jsonAlcoholValue = jsonAlcoholValue + 'ppm' + '&#128567;';
                        document.getElementById("alcoholIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonAlcoholValue >= 1000 && jsonAlcoholValue <= 5000) {
                        jsonAlcoholValue = jsonAlcoholValue + 'ppm' + '&#128577;';
                        document.getElementById("alcoholIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonAlcoholValue < 1000) {
                        jsonAlcoholValue = jsonAlcoholValue + 'ppm' + '&#128516;';
                        document.getElementById("alcoholIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestAlcohol').innerHTML = jsonAlcoholValue;
                    var iterator = alcoholArray.values();

                    var timeArray = [];
                    var alcoholValueArray = [];
                    for (let elements of iterator) {
                        timeArray.push(Object.keys(elements).toString());
                        let cleanAlcohol = JSON.stringify(Object.values(elements));
                        cleanAlcohol = cleanAlcohol.split(":").pop();
                        cleanAlcohol = cleanAlcohol.replaceAll("\"", "");
                        cleanAlcohol = cleanAlcohol.replaceAll("}", "");
                        cleanAlcohol = cleanAlcohol.replaceAll("]", "");
                        alcoholValueArray.push(cleanAlcohol);
                    }

                    if (document.getElementById("alcoholDateArray").value === date) {
                        document.getElementById("alcoholChartContainer").innerHTML = "";
                        document.getElementById('alcoholChartContainer').innerHTML = "<canvas id=\"alcoholChart\"></canvas>";
                        new Chart("alcoholChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: alcoholValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 40000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ135/Ammonia/').once('value', (snap) => {
                    ammoniaDays = snap.val();
                    ammoniaDays = Object.keys(ammoniaDays);
                    ammoniaDays.sort(dateComparison);

                    for (var i = 0; i < ammoniaDays.length; i++) {
                        var option = ammoniaDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        ammoniaDateSelect.prepend(element);
                    }
                    document.getElementById("ammoniaDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayAmmonia).on('value', (snap) => {
                    var ammoniaStr = snap.val();
                    var ammoniaArray = [];
                    Object.keys(ammoniaStr).forEach((key) => {
                        ammoniaArray.push({[key]: ammoniaStr[key]});
                    });

                    var latestAmmonia = ammoniaArray[ammoniaArray.length - 1];
                    var ammoniaValue = Object.values(latestAmmonia);
                    var jsonAmmoniaValue = JSON.stringify(ammoniaValue);

                    jsonAmmoniaValue = jsonAmmoniaValue.split(":").pop();
                    jsonAmmoniaValue = jsonAmmoniaValue.replaceAll("\"", "");
                    jsonAmmoniaValue = jsonAmmoniaValue.replaceAll("}", "");
                    jsonAmmoniaValue = jsonAmmoniaValue.replaceAll("]", "");

                    if (jsonAmmoniaValue >= 800) {
                        jsonAmmoniaValue = jsonAmmoniaValue + 'ppm' + '&#128128;';
                        document.getElementById("ammoniaIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonAmmoniaValue >= 400 && jsonAmmoniaValue < 800) {
                        jsonAmmoniaValue = jsonAmmoniaValue + 'ppm' + '&#128567;';
                        document.getElementById("ammoniaIndicator").style.backgroundColor = "	#FFA500";
                    }
                    if (jsonAmmoniaValue < 400) {
                        jsonAmmoniaValue = jsonAmmoniaValue + 'ppm' + '&#128516;';
                        document.getElementById("ammoniaIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestAmmonia').innerHTML = jsonAmmoniaValue;
                    var iterator = ammoniaArray.values();

                    var timeArray = [];
                    var ammoniaValueArray = [];
                    for (let elements of iterator) {
                        timeArray.push(Object.keys(elements).toString());
                        let cleanAmmonia = JSON.stringify(Object.values(elements));
                        cleanAmmonia = cleanAmmonia.split(":").pop();
                        cleanAmmonia = cleanAmmonia.replaceAll("\"", "");
                        cleanAmmonia = cleanAmmonia.replaceAll("}", "");
                        cleanAmmonia = cleanAmmonia.replaceAll("]", "");
                        ammoniaValueArray.push(cleanAmmonia);
                    }

                    if (document.getElementById("ammoniaDateArray").value === date) {
                        document.getElementById("ammoniaChartContainer").innerHTML = "";
                        document.getElementById('ammoniaChartContainer').innerHTML = "<canvas id=\"ammoniaChart\"></canvas>";
                        new Chart("ammoniaChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: ammoniaValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ135/Acetone/').once('value', (snap) => {
                acetoneDays = snap.val();
                acetoneDays = Object.keys(acetoneDays);
                acetoneDays.sort(dateComparison);

                for (var i = 0; i < acetoneDays.length; i++) {
                    var option = acetoneDays[i];
                    var element = document.createElement("option");
                    element.textContent = option;
                    element.value = option;
                    acetoneDateSelect.prepend(element);
                }
                document.getElementById("acetoneDateArray").selectedIndex = "0";
            });

                firebase.database().ref(currentDayAcetone).on('value', (snap) => {
                var acetoneStr = snap.val();
                var acetoneArray = [];
                Object.keys(acetoneStr).forEach((key) => {
                    acetoneArray.push({[key]: acetoneStr[key]});
                });

                var latestAcetone = acetoneArray[acetoneArray.length - 1];
                var acetoneValue = Object.values(latestAcetone);
                var jsonAcetoneValue = JSON.stringify(acetoneValue);

                jsonAcetoneValue = jsonAcetoneValue.split(":").pop();
                jsonAcetoneValue = jsonAcetoneValue.replaceAll("\"", "");
                jsonAcetoneValue = jsonAcetoneValue.replaceAll("}", "");
                jsonAcetoneValue = jsonAcetoneValue.replaceAll("]", "");

                if (jsonAcetoneValue >= 800) {
                    jsonAcetoneValue = jsonAcetoneValue + 'ppm' + '&#128128;';
                    document.getElementById("acetoneIndicator").style.backgroundColor = "#bd1816";
                }
                if (jsonAcetoneValue >= 400 && jsonAcetoneValue < 800) {
                    jsonAcetoneValue = jsonAcetoneValue + 'ppm' + '&#128567;';
                    document.getElementById("acetoneIndicator").style.backgroundColor = "	#FFA500";
                }
                if (jsonAcetoneValue < 400) {
                    jsonAcetoneValue = jsonAcetoneValue + 'ppm' + '&#128516;';
                    document.getElementById("acetoneIndicator").style.backgroundColor = "#4CBB17";
                }

                document.getElementById('latestAcetone').innerHTML = jsonAcetoneValue;
                var iterator = acetoneArray.values();

                var timeArray = [];
                var acetoneValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanAcetone = JSON.stringify(Object.values(elements));
                    cleanAcetone = cleanAcetone.split(":").pop();
                    cleanAcetone = cleanAcetone.replaceAll("\"", "");
                    cleanAcetone = cleanAcetone.replaceAll("}", "");
                    cleanAcetone = cleanAcetone.replaceAll("]", "");
                    acetoneValueArray.push(cleanAcetone);
                }

                if (document.getElementById("acetoneDateArray").value === date) {
                    document.getElementById("acetoneChartContainer").innerHTML = "";
                    document.getElementById('acetoneChartContainer').innerHTML = "<canvas id=\"acetoneChart\"></canvas>";
                    new Chart("acetoneChart", {
                        type: "line",
                        data: {
                            labels: timeArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: acetoneValueArray
                            }]
                        },
                        options: {
                            legend: {display: false},
                            scales: {
                                yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                xAxes: [{
                                    ticks: {
                                        display: true,
                                        autoSkip: true,
                                        maxTicksLimit: 24
                                    }
                                }],
                            }
                        }
                    });
                }
            });

                await firebase.database().ref('MQ2/LPG/').once('value', (snap) => {
                    LPGDays = snap.val();
                    LPGDays = Object.keys(LPGDays);
                    LPGDays.sort(dateComparison);

                    for (var i = 0; i < LPGDays.length; i++) {
                        var option = LPGDays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        LPGDateSelect.prepend(element);
                    }
                    document.getElementById("LPGDateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayLPG).on('value', (snap) => {
                    var LPGStr = snap.val();
                    var LPGArray = [];
                    Object.keys(LPGStr).forEach((key) => {
                        LPGArray.push({[key]: LPGStr[key]});
                    });

                    var latestLPG = LPGArray[LPGArray.length - 1];
                    var LPGValue = Object.values(latestLPG);
                    var jsonLPGValue = JSON.stringify(LPGValue);

                    jsonLPGValue = jsonLPGValue.split(":").pop();
                    jsonLPGValue = jsonLPGValue.replaceAll("\"", "");
                    jsonLPGValue = jsonLPGValue.replaceAll("}", "");
                    jsonLPGValue = jsonLPGValue.replaceAll("]", "");

                    if (jsonLPGValue >= 1000) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128128;';
                        document.getElementById("LPGIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonLPGValue >= 500 && jsonLPGValue < 1000) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128567;';
                        document.getElementById("LPGIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonLPGValue < 500) {
                        jsonLPGValue = jsonLPGValue + 'ppm' + '&#128516;';
                        document.getElementById("LPGIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestLPG').innerHTML = jsonLPGValue;
                    var iterator = LPGArray.values();


                    var timeArray = [];
                    var LPGValueArray = [];
                    for (let elements of iterator) {
                        timeArray.push(Object.keys(elements).toString());
                        let cleanLPG = JSON.stringify(Object.values(elements));
                        cleanLPG = cleanLPG.split(":").pop();
                        cleanLPG = cleanLPG.replaceAll("\"", "");
                        cleanLPG = cleanLPG.replaceAll("}", "");
                        cleanLPG = cleanLPG.replaceAll("]", "");
                        LPGValueArray.push(cleanLPG);
                    }

                    if (document.getElementById("LPGDateArray").value === date) {
                        document.getElementById("LPGChartContainer").innerHTML = "";
                        document.getElementById('LPGChartContainer').innerHTML = "<canvas id=\"LPGChart\"></canvas>";
                        new Chart("LPGChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: LPGValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 5000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('MQ2/CO/').once('value', (snap) => {
                    CODays = snap.val();
                    CODays = Object.keys(CODays);
                    CODays.sort(dateComparison);

                    for (var i = 0; i < CODays.length; i++) {
                        var option = CODays[i];
                        var element = document.createElement("option");
                        element.textContent = option;
                        element.value = option;
                        CODateSelect.prepend(element);
                    }
                    document.getElementById("CODateArray").selectedIndex = "0";
                });

                firebase.database().ref(currentDayCO).on('value', (snap) => {
                    var COStr = snap.val();
                    var COArray = [];
                    Object.keys(COStr).forEach((key) => {
                        COArray.push({[key]: COStr[key]});
                    });

                    var latestCO = COArray[COArray.length - 1];
                    var COValue = Object.values(latestCO);
                    var jsonCOValue = JSON.stringify(COValue);

                    jsonCOValue = jsonCOValue.split(":").pop();
                    jsonCOValue = jsonCOValue.replaceAll("\"", "");
                    jsonCOValue = jsonCOValue.replaceAll("}", "");
                    jsonCOValue = jsonCOValue.replaceAll("]", "");

                    if (jsonCOValue >= 800) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128128;';
                        document.getElementById("COIndicator").style.backgroundColor = "#bd1816";
                    }
                    if (jsonCOValue >= 400 && jsonCOValue < 800) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128567;';
                        document.getElementById("COIndicator").style.backgroundColor = "#FFA500";
                    }
                    if (jsonCOValue < 400) {
                        jsonCOValue = jsonCOValue + 'ppm' + '&#128516;';
                        document.getElementById("COIndicator").style.backgroundColor = "#4CBB17";
                    }

                    document.getElementById('latestCO').innerHTML = jsonCOValue;
                    var iterator = COArray.values();

                    var timeArray = [];
                    var COValueArray = [];
                    for (let elements of iterator) {
                        timeArray.push(Object.keys(elements).toString());
                        let cleanCO = JSON.stringify(Object.values(elements));
                        cleanCO = cleanCO.split(":").pop();
                        cleanCO = cleanCO.replaceAll("\"", "");
                        cleanCO = cleanCO.replaceAll("}", "");
                        cleanCO = cleanCO.replaceAll("]", "");
                        COValueArray.push(cleanCO);
                    }

                    if (document.getElementById("CODateArray").value === date) {
                        document.getElementById("COChartContainer").innerHTML = "";
                        document.getElementById('COChartContainer').innerHTML = "<canvas id=\"COChart\"></canvas>";
                        new Chart("COChart", {
                            type: "line",
                            data: {
                                labels: timeArray,
                                datasets: [{
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: "rgba(0,0,255,1.0)",
                                    borderColor: "rgba(0,0,255,0.1)",
                                    data: COValueArray
                                }]
                            },
                            options: {
                                legend: {display: false},
                                scales: {
                                    yAxes: [{ticks: {min: 0.00, max: 10000.00}}],
                                    xAxes: [{
                                        ticks: {
                                            display: true,
                                            autoSkip: true,
                                            maxTicksLimit: 24
                                        }
                                    }],
                                }
                            }
                        });
                    }
                });

                await firebase.database().ref('DSM501A/PM25/').once('value', (snap) => {
                PM25Days = snap.val();
                PM25Days = Object.keys(PM25Days);
                PM25Days.sort(dateComparison);
                for (var i = 0; i < PM25Days.length; i++) {
                    var option = PM25Days[i];
                    var element = document.createElement("option");
                    element.textContent = option;
                    element.value = option;
                    PM25DateSelect.prepend(element);
                }
                document.getElementById("PM25DateArray").selectedIndex = "0";
            });

                firebase.database().ref(currentDayPM25).on('value', (snap) => {
                var PM25Str = snap.val();
                var PM25Array = [];
                Object.keys(PM25Str).forEach((key) => {
                    PM25Array.push({[key]: PM25Str[key]});
                });

                var latestPM25 = PM25Array[PM25Array.length - 1];
                var PM25Value = Object.values(latestPM25);
                var jsonPM25Value = JSON.stringify(PM25Value);

                jsonPM25Value = jsonPM25Value.split(":").pop();
                jsonPM25Value = jsonPM25Value.replaceAll("\"", "");
                jsonPM25Value = jsonPM25Value.replaceAll("}", "");
                jsonPM25Value = jsonPM25Value.replaceAll("]", "");

                if (jsonPM25Value >= 8) {
                    jsonPM25Value = jsonPM25Value + 'ppm' + '&#128128;';
                    document.getElementById("PM25Indicator").style.backgroundColor = "#bd1816";
                }
                if (jsonPM25Value >= 5 && jsonPM25Value <= 7) {
                    jsonPM25Value = jsonPM25Value + 'ppm' + '&#128567;';
                    document.getElementById("PM25Indicator").style.backgroundColor = "#FFA500";
                }
                if (jsonPM25Value <= 4) {
                    jsonPM25Value = jsonPM25Value + 'ppm' + '&#128516;';
                    document.getElementById("PM25Indicator").style.backgroundColor = "#4CBB17";
                }

                document.getElementById('latestPM25').innerHTML = jsonPM25Value;

                var iterator = PM25Array.values();
                var timeArray = [];
                var PM25ValueArray = [];
                for (let elements of iterator) {
                    timeArray.push(Object.keys(elements).toString());
                    let cleanPM25 = JSON.stringify(Object.values(elements));
                    cleanPM25 = cleanPM25.split(":").pop();
                    cleanPM25 = cleanPM25.replaceAll("\"", "");
                    cleanPM25 = cleanPM25.replaceAll("}", "");
                    cleanPM25 = cleanPM25.replaceAll("]", "");
                    PM25ValueArray.push(cleanPM25);
                }

                if (document.getElementById("PM25DateArray").value === date) {
                    document.getElementById("PM25ChartContainer").innerHTML = "";
                    document.getElementById('PM25ChartContainer').innerHTML = "<canvas id=\"PM25Chart\"></canvas>";
                    new Chart("PM25Chart", {
                        type: "line",
                        data: {
                            labels: timeArray,
                            datasets: [{
                                fill: false,
                                lineTension: 0,
                                backgroundColor: "rgba(0,0,255,1.0)",
                                borderColor: "rgba(0,0,255,0.1)",
                                data: PM25ValueArray
                            }]
                        },
                        options: {
                            legend: {display: false},
                            scales: {
                                yAxes: [{ticks: {min: 0.00, max: 50.00}}],
                                xAxes: [{
                                    ticks: {
                                        display: true,
                                        autoSkip: true,
                                        maxTicksLimit: 24
                                    }
                                }],
                            }
                        }
                    });
                }
            });
            }
        );
    </script>
</div>
</body>
</html>